<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Epstein Zeta Library: Epstein Zeta Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
  loader: {
    load: ['[tex]/ams','[tex]/newcommand','[tex]/noundefined','[tex]/require','[tex]/autoload','[tex]/configmacros']
  },
  tex: {
    macros: {},
    packages: ['base','configmacros','ams','newcommand','noundefined','require','autoload','configmacros']
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Epstein Zeta Library<span id="projectnumber">&#160;0.2.0</span>
   </div>
   <div id="projectbrief">Calculates the Epstein Zeta function</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Epstein Zeta Library </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a></p>
<h2><a class="anchor" id="autotoc_md0"></a>
EpsteinLib</h2>
<p>Experimental alpha version 0.1.0</p>
<p>Authors: Andreas A. Buchheit, Jonathan Busse, Ruben Gutendorf, DevOps: Jan Schmitz</p>
<p>Contact: <a href="#" onclick="location.href='mai'+'lto:'+'buc'+'hh'+'eit'+'@n'+'um.'+'un'+'i-s'+'b.'+'de'; return false;">buchh<span class="obfuscator">.nosp@m.</span>eit@<span class="obfuscator">.nosp@m.</span>num.u<span class="obfuscator">.nosp@m.</span>ni-s<span class="obfuscator">.nosp@m.</span>b.de</a></p>
<p>EpsteinLib is a C library for the fast and efficient computation of the Epstein zeta function for arbitary multidimensional lattices. Originally studied by Epstein [1,2], it forms the basis for the computation of general multidimensional lattice sums in classical and quantum physics applications [3]. Together with its regularization, it serves as the central ingredient in the singular Euler-Maclaurin (SEM) expansion, which generalizes the 300-year-old Euler summation formula to lattice sums in higher dimensions with physically relevant power-law interactions [4-5]. An efficiently computable representation of the Epstein zeta function is provided in [6,7].</p>
<p>For a \(d\)-dimensional lattice \(\Lambda=A\mathbb Z^d\), with \(A\in \mathbb R^{d\times d}\) regular, \(x,y \in \mathbb R^d\), and \(\nu \in \mathbb C\), the Epstein zeta function is defined by the Dirichlet series $$ Z_{\Lambda,\nu}\begin{vmatrix} x \ y \end{vmatrix} = \sum_{z \in \Lambda}{}^{'} \frac{e^{-2\pi i y \cdot z}}{\left| x- z\right|^\nu},\quad \mathrm{Re}(\nu)&gt;d, $$ which can be meromorphically continued to \(\nu \in \mathbb C\). Here, the primed sum excludes the case \(z = x.\)</p>
<p>The Epstein zeta function is implemented in this library as</p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> complex <a class="code hl_function" href="epsteinZeta_8c.html#afbe1bf38bc25fc754512cecac2c7cf71">epsteinZeta</a>(<span class="keywordtype">double</span> nu, <span class="keywordtype">int</span> dim, <span class="keywordtype">double</span> *A, <span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *y);</div>
<div class="ttc" id="aepsteinZeta_8c_html_afbe1bf38bc25fc754512cecac2c7cf71"><div class="ttname"><a href="epsteinZeta_8c.html#afbe1bf38bc25fc754512cecac2c7cf71">epsteinZeta</a></div><div class="ttdeci">double complex epsteinZeta(double nu, int dim, const double *a, const double *x, const double *y)</div><div class="ttdoc">calculates the Epstein Zeta function.</div><div class="ttdef"><b>Definition</b> epsteinZeta.c:34</div></div>
</div><!-- fragment --><p> and evalutates to full precision over the whole parameter range for \(\nu \in (-10,10)\).</p>
<p>In addition, this library includes the regularized Epstein zeta function, which is analytic around \(y=0\), and is defined via $$ Z_{\Lambda,\nu}^{\mathrm{reg}}\begin{vmatrix} x \ y \end{vmatrix} = e^{2\pi i x\cdot y} Z_{\Lambda,\nu}\left|\begin{aligned} x \ y \end{aligned}\right| -\frac{\hat{s}(y)}{V_{\Lambda}}, $$ where \(V_{\Lambda}=|\det A|\) is the volume of the elementary lattice cell, $$ \hat{s}(y)=-\pi^{\nu-\frac{d}{2}} \frac{\Gamma((d-\nu)/2)}{\Gamma(\nu/2)}|y|^{\nu-d} $$ is the distributional Fourier transform of \(\vert z \vert^{-\nu}\), where \(\Gamma\) denotes the gamma function.</p>
<p>In this library, the regularized Epstein zeta function is included as </p><div class="fragment"><div class="line"><span class="keywordtype">double</span> complex <a class="code hl_function" href="epsteinZeta_8c.html#a2bc760eb6d2bc0fe082a89ad1a885111">epsteinZetaReg</a>(<span class="keywordtype">double</span> nu, <span class="keywordtype">int</span> dim, <span class="keywordtype">double</span> *A, <span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *y);</div>
<div class="ttc" id="aepsteinZeta_8c_html_a2bc760eb6d2bc0fe082a89ad1a885111"><div class="ttname"><a href="epsteinZeta_8c.html#a2bc760eb6d2bc0fe082a89ad1a885111">epsteinZetaReg</a></div><div class="ttdeci">double complex epsteinZetaReg(double nu, int dim, const double *a, const double *x, const double *y)</div><div class="ttdoc">calculates the regularized Epstein Zeta function.</div><div class="ttdef"><b>Definition</b> epsteinZeta.c:49</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1"></a>
Installation with meson</h2>
<ol type="1">
<li>Install meson, ninja, pkg-config, lapacke, e.g. with <div class="fragment"><div class="line"># Archlinux</div>
<div class="line">pacman -S meson ninja pkgconf lapacke</div>
<div class="line"> </div>
<div class="line"># MacOS</div>
<div class="line">brew install meson ninja pkg-config lapack</div>
</div><!-- fragment --></li>
<li><code>cd &lt;path/to/repo&gt;</code></li>
<li><code>meson setup build</code></li>
<li><code>meson compile -C build</code></li>
<li>To test the library, run <code>meson test -C build</code> </li>
</ol>
<h3><a class="anchor" id="autotoc_md2"></a>
For system-wide installation</h3>
<p>Meson supports a system-wide installation of the compiled library. After that, you can use <code>#include &lt;<a class="el" href="epsteinZeta_8h.html" title="Calculates the (regularized) Epstein zeta function.">epsteinZeta.h</a>&gt;</code> and link with <code>gcc -lepsteinZeta</code>. This may require superuser rights.</p>
<ol type="1">
<li>To install system-wide: <code>meson install -C build</code>.</li>
<li>Try to compile the sample program in <code><a class="el" href="lattice__sum_8c.html" title="Calculates the Madelung constant.">test/lattice_sum.c</a></code> with the command <code>gcc -o lattice_sum <a class="el" href="lattice__sum_8c.html" title="Calculates the Madelung constant.">lattice_sum.c</a> -lm -lepsteinZeta</code>. You may encounter the problem that the shared library cannot be found. In this case, you need to modify the environment variables. Please continue with the next step. Otherwise, you are done.</li>
<li>Update the environment variables to correctly locate the shared library at runtime. You can find <code>/path/to/library</code> in the output given by <code>meson install</code>. <div class="fragment"><div class="line"># Linux</div>
<div class="line">export \f$LD_LIBRARY_PATH=\f$LD_LIBRARY_PATH:/path/to/library</div>
<div class="line"> </div>
<div class="line"># MacOS</div>
<div class="line">export \f$DYLD_LIBRARY_PATH=\f$DYLD_LIBRARY_PATH:/path/to/library</div>
</div><!-- fragment --></li>
</ol>
<h3><a class="anchor" id="autotoc_md3"></a>
For local installation</h3>
<ol type="1">
<li>Copy the header <code>include/epsteinZeta.h</code> and move the compiled library <code>build/src/libepsteinZeta.so</code> to places of your choice, e. g. <div class="fragment"><div class="line">cp include/epsteinZeta.h /your/path/to/include</div>
<div class="line">mv build/src/libepsteinZeta.so /your/path/to/library</div>
</div><!-- fragment --></li>
<li>To test your library, try to compile <code><a class="el" href="lattice__sum_8c.html" title="Calculates the Madelung constant.">test/lattice_sum.c</a></code> with the command <code>gcc -o lattice_sum <a class="el" href="lattice__sum_8c.html" title="Calculates the Madelung constant.">lattice_sum.c</a> -lm -L/your/path/to/library -lepsteinZeta -I/your/path/to/include</code>.</li>
</ol>
<h2><a class="anchor" id="autotoc_md4"></a>
View api documentation</h2>
<ol type="1">
<li>install <a href="https://www.doxygen.nl/manual/install.html">doxygen</a></li>
<li><code>cd &lt;path/to/repo&gt;</code></li>
<li><code>doxygen</code></li>
<li>open <code>html/index.html</code> in browser</li>
</ol>
<h2><a class="anchor" id="autotoc_md5"></a>
Usage</h2>
<p>Minimal working examples for calculating the Madelung constant in \(3\) dimensions. </p>
<h3><a class="anchor" id="autotoc_md6"></a>
in c</h3>
<div class="fragment"><div class="line"> c</div>
<div class="line">// If the library is installed, compile with `gcc -o lattice_sum lattice_sum.c -lm -lepsteinZeta </div>
<div class="line">// If the library is not installed, compile with `gcc -o lattice_sum lattice_sum.c -lm -L/path/to/library -lepsteinZeta -I/path/to/include</div>
<div class="line"> </div>
<div class="line">#include &lt;complex.h&gt;</div>
<div class="line">#include &lt;math.h&gt;</div>
<div class="line">#include &lt;stdio.h&gt;</div>
<div class="line">#include &quot;epsteinZeta.h&quot;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">int main() {</div>
<div class="line"> </div>
<div class="line">    // Madelung constant found in literature</div>
<div class="line">    double madelungRef = -1.7475645946331821906362120355443974;</div>
<div class="line">    int dim = 3;</div>
<div class="line">    double m[] = {1, 0, 0, 0, 1,</div>
<div class="line">                  0, 0, 0, 1};    // identity matrix for whole numbers</div>
<div class="line">    double x[] = {0, 0, 0};       // no shift</div>
<div class="line">    double y[] = {0.5, 0.5, 0.5}; // alternating sum</div>
<div class="line">    double nu = 1.0;</div>
<div class="line">    double madelung = creal(epsteinZeta(nu, dim, m, x, y));</div>
<div class="line">    printf(&quot;Madelung sum in 3 dimensions:\t %.16lf\n&quot;, creal(madelung));</div>
<div class="line">    printf(&quot;Reference value:\t\t %.16lf\n&quot;, madelungRef);</div>
<div class="line">    printf(&quot;Relative error:\t\t\t +%.2e\n&quot;,</div>
<div class="line">           fabs(madelungRef - madelung) / fabs(madelungRef));</div>
<div class="line"> </div>
<div class="line">    return fabs(madelung - madelungRef) &gt; pow(10, -14);</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7"></a>
Contributing</h2>
<p>Pull requests are welcome. For major changes, please open an issue first to discuss what you would like to change.</p>
<h2><a class="anchor" id="autotoc_md8"></a>
References</h2>
<p>[1] P. Epstein. “Zur Theorie allgemeiner Zetafunctionen”. Math. Ann. 56 (1903), pp. 615–644.</p>
<p>[2] P. Epstein. “Zur Theorie allgemeiner Zetafunktionen. II”. Math. Ann. 63 (1906), pp. 205–216</p>
<p>[3] Andreas A. Buchheit et al. “Exact Continuum Representation of Long-range Interacting Systems and Emerging Exotic Phases in Unconventional Superconductors”, Phys. Rev. Research 5, 043065 (2023)</p>
<p>[4] Andreas A Buchheit and Torsten Keßler. “On the Efficient Computation of Large Scale Singular Sums with Applications to Long-Range Forces in Crystal Lattices”. J. Sci. Comput. 90.1 (2022), pp. 1–20</p>
<p>[5] Andreas A Buchheit and Torsten Keßler. “Singular Euler–Maclaurin expansion on multidimensional lattices”. Nonlinearity 35.7 (2022), p. 3706</p>
<p>[6] R. Crandall. “Unified algorithms for polylogarithm, L-series, and zeta variants”. Algorithmic Reflections: Selected Works. PSIpress, 2012</p>
<p>[7] Andreas A. Buchheit, Torsten Keßler, and Kirill Serkh. "On the computation of lattice sums without translational invariance". arXiv preprint arXiv:2403.03213. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"/>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
